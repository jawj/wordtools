/*! For license information please see 111.app.js.LICENSE.txt */
(()=>{"use strict";const t=Symbol("Comlink.proxy"),e=Symbol("Comlink.endpoint"),n=Symbol("Comlink.releaseProxy"),r=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),s=t=>"object"==typeof t&&null!==t||"function"==typeof t,a={canHandle:e=>s(e)&&e[t],serialize(t){const{port1:e,port2:n}=new MessageChannel;return c(t,e),[n,[n]]},deserialize:t=>(t.start(),function(t){const e=new Map;return t.addEventListener("message",(function(t){const{data:n}=t;if(!n||!n.id)return;const r=e.get(n.id);if(r)try{r(n)}finally{e.delete(n.id)}})),h(t,e,[],void 0)}(t))},i=new Map([["proxy",a],["throw",{canHandle:t=>s(t)&&o in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function c(e,n=globalThis,s=["*"]){n.addEventListener("message",(function a(i){if(!i||!i.data)return;if(!function(t,e){for(const n of t){if(e===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}return!1}(s,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:u,type:f,path:p}=Object.assign({path:[]},i.data),g=(i.data.argumentList||[]).map(w);let h;try{const n=p.slice(0,-1).reduce(((t,e)=>t[e]),e),r=p.reduce(((t,e)=>t[e]),e);switch(f){case"GET":h=r;break;case"SET":n[p.slice(-1)[0]]=w(i.data.value),h=!0;break;case"APPLY":h=r.apply(n,g);break;case"CONSTRUCT":h=function(e){return Object.assign(e,{[t]:!0})}(new r(...g));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;c(e,n),h=function(t,e){return m.set(t,e),t}(t,[t])}break;case"RELEASE":h=void 0;break;default:return}}catch(t){h={value:t,[o]:0}}Promise.resolve(h).catch((t=>({value:t,[o]:0}))).then((t=>{const[o,s]=y(t);n.postMessage(Object.assign(Object.assign({},o),{id:u}),s),"RELEASE"===f&&(n.removeEventListener("message",a),l(n),r in e&&"function"==typeof e[r]&&e[r]())})).catch((t=>{const[e,r]=y({value:new TypeError("Unserializable return value"),[o]:0});n.postMessage(Object.assign(Object.assign({},e),{id:u}),r)}))})),n.start&&n.start()}function l(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function u(t){if(t)throw new Error("Proxy has been released and is not useable")}function f(t){return v(t,new Map,{type:"RELEASE"}).then((()=>{l(t)}))}const p=new WeakMap,g="FinalizationRegistry"in globalThis&&new FinalizationRegistry((t=>{const e=(p.get(t)||0)-1;p.set(t,e),0===e&&f(t)}));function h(t,r,o=[],s=function(){}){let a=!1;const i=new Proxy(s,{get(e,s){if(u(a),s===n)return()=>{!function(t){g&&g.unregister(t)}(i),f(t),r.clear(),a=!0};if("then"===s){if(0===o.length)return{then:()=>i};const e=v(t,r,{type:"GET",path:o.map((t=>t.toString()))}).then(w);return e.then.bind(e)}return h(t,r,[...o,s])},set(e,n,s){u(a);const[i,c]=y(s);return v(t,r,{type:"SET",path:[...o,n].map((t=>t.toString())),value:i},c).then(w)},apply(n,s,i){u(a);const c=o[o.length-1];if(c===e)return v(t,r,{type:"ENDPOINT"}).then(w);if("bind"===c)return h(t,r,o.slice(0,-1));const[l,f]=d(i);return v(t,r,{type:"APPLY",path:o.map((t=>t.toString())),argumentList:l},f).then(w)},construct(e,n){u(a);const[s,i]=d(n);return v(t,r,{type:"CONSTRUCT",path:o.map((t=>t.toString())),argumentList:s},i).then(w)}});return function(t,e){const n=(p.get(e)||0)+1;p.set(e,n),g&&g.register(t,e,t)}(i,t),i}function d(t){const e=t.map(y);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const m=new WeakMap;function y(t){for(const[e,n]of i)if(n.canHandle(t)){const[r,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:t},m.get(t)||[]]}function w(t){switch(t.type){case"HANDLER":return i.get(t.name).deserialize(t.value);case"RAW":return t.value}}function v(t,e,n,r){return new Promise((o=>{const s=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.set(s,o),t.start&&t.start(),t.postMessage(Object.assign({id:s},n),r)}))}let E,b,S,k,M,T,j,C;async function L(){if(void 0===E){const t=await fetch("words.json");E=await t.json()}}async function R(){return await L(),E}function A(t){const e=t.length-2,n=t[e],r=++t[e+1];for(let o=0;o<e;o++){const e=t[o],s=e>>>16,a=1+(65535&e);if(a<=s)return t[o]=s<<16|a,r<n;t[o]=s<<16}throw new Error("This should be impossible")}function*P(t,e=[]){for(const[n,r]of function*(t){var[e,n]=function(t){const e=t.split("").sort(),n=[],r=[];let o;for(const t of e)o!==t&&(n.push(t),r.push(0)),r[r.length-1]++,o=t;return[n,r]}(t),r=function(t){const e=t.length,n=new Uint32Array(e+2);let r=1,o=0;for(;o<e;o++){const e=t[o];n[o]=e<<16,r*=e+1}return n[o]=Math.ceil(r/2),n}(n);const o=e.length;do{let t="",n="";for(let s=0;s<o;s++){const o=e[s],a=r[s],i=a>>>16;let c=65535&a;t+=o.repeat(c),n+=o.repeat(i-c)}yield[n,t]}while(A(r))}(t)){if(!S[n])continue;const t=[...e,n];""===r?yield t:yield*P(r,t)}}function*O(t){const e=t.map((t=>t.length)),n=t.map((()=>0));for(;;){yield t.map(((t,e)=>t[n[e]]));for(let t=0;t<n.length&&(n[t]++,!(n[t]<e[t]));t++){if(t===n.length-1)return;n[t]=0}}}function z(t,e){return t.reduce(((t,n)=>{const r=e[n]+.01*n.length;return t<r?t:r}),1/0)/t.length**2.5}function N(){k=!1,M=!1,T=0,j=5e4,C=[]}N();const x={loadWordWeights:L,getWordsCount:async function(){return await L(),Object.keys(E).length},wordsMatchingPattern:async function(t,e,n,r,o){let s;try{s=(null==b?void 0:b.pattern)===t?b.results:await async function(t){const e=t.startsWith("~"),n=t.endsWith("<"),r=e?t:t.toLowerCase().replace(/[^a-z.?*]/g,""),o=e?new RegExp(r.slice(1),"i"):function(t){return new RegExp("^"+t.replace(/[*]/g,".*").replace(/[?]/g,".")+"$")}(r),s=await R();let a=[];for(const t in s)o.test(t)&&a.push(t);if(n){const t=new Set;for(const e of a)t.add(e.split("").reverse().join(""));const e=[];for(const n in s)t.has(n)&&e.push(n);a=e}return a}(t)}catch(r){return s=[r.message],b={pattern:t,order:e,direction:n,results:s},{count:-1,results:s}}if((null==b?void 0:b.pattern)!==t||b.order!==e){const t=await R(),r="asc"===n?1:-1;s.sort("freq"===e?(e,n)=>r*(t[e]-t[n]):"length"===e?(e,n)=>r*(e.length-n.length||t[n]-t[e]):(t,e)=>r*t.localeCompare(e))}else b.direction!==n&&s.reverse();return b={pattern:t,order:e,direction:n,results:s},{count:s.length,results:s.slice(r,r+o)}},find:async function(t,e=1e4){var n;if(!(t=function(t){return t.toLowerCase().replace(/[^a-z]+/g,"")}(t)).length)return;N();const r=await R();!function(t){var e;if(!S){S={};for(const n in t){const t=n.split("").sort().join("");null!==(e=S[t])&&void 0!==e||(S[t]=[]),S[t].push(n)}}}(r);for(const s of P(t)){const t=s.map((t=>S[t])),[,a]=null!==(n=(o=C)[o.length-1])&&void 0!==n?n:[,-1/0];for(const n of O(t)){T++;const t=z(n,r);(t>a||C.length<e)&&C.push([n,t])}if(C.length>e&&(C.sort((([,t],[,e])=>e-t)),C.splice(e)),T>=j){if(await new Promise((t=>setTimeout(t,0))),k)break;j+=5e4}}var o;M=!0},abort:()=>k=!0,finished:()=>M,evaluated:()=>T,anagrams:t=>C.slice(0,t)};c(x)})();